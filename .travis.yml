language: java

jdk:
  - openjdk11

services:
  - docker

addons:
  apt:
    packages:
      - docker-ce

before_install:
  - echo -n "*** LIFECYCLE STARTED - 'before_install' *****************************************************************"
  - echo -n "*** LIFECYCLE COMPLETED - before_install *****************************************************************"

# Note: 'Install' here means things into the Travis environment that are needed.
install:
  - echo "*** LIFECYCLE STARTED - 'install' ***************************************************************************"
  - echo "*** LIFECYCLE COMPLETED - 'install' *************************************************************************"

# Build the code then build the javadoc.
before_script:
  - echo -n "*** LIFECYCLE STARTED - 'before_script' ******************************************************************"
  - mvn package -DskipTests=true -Dmaven.javadoc.skip=true -B -V
#  - mvn javadoc:javadoc -B -V
  - echo -n "*** LIFECYCLE COMPLETED - 'before_script' ****************************************************************"

# Used here to upload the docker file to Docker Hub.
script:
  - echo -n "*** LIFECYCLE STARTED - 'script' *************************************************************************"
#  - echo "$DOCKER_PASSWORD" | docker login -u "$DOCKER_USERNAME" --password-stdin
#  - docker build -t paulscherrerinstitute/wica-stream:latest -f docker/Dockerfile.http .
#  - docker push paulscherrerinstitute/wica-stream:latest
#  - echo -n "LIFECYCLE COMPLETED - 'script' ***************************************************************************"

# The deploy phase is optional and runs after the script. Here we use it to publish
# the Javadoc on the GitHub pages site.
deploy:
  provider: releases
  api_key:
    secure: "kwpC80xgi3p82/T4B6f+Iilk4qMGEG2M19rPTAGno7W7b9x6rga9p9yvrQDHXwKSa/I1rov6AqA73Rl97gc8+RGZLJq9R0aCSbkGac43tvI7okIOECG5vOfM9H4kSsH8dkn0sgI7P5j/RZ6H3syscm6Lf8V5U8r75TbBXXFB+MVVA5Vme244QmGc+FQ5WsjcfNTQATWobTz1cWiZ2xjeXcAcyTWU4E503kCrb7DlgdhCF6qMFXmOyxzzQpVea1jz6rFN6SnNOs6cv3InXO13BIb1vOFsdAnEAJ1QKbG00edYtkul8e5M6qEo/i+U2r1+UKq7QvoU/dDyXSGwuXSmoG61g4WTkac2gGmwbFT7jNQKHLeI9JRSEVm2OvDrEqlxsfQ1k8fogMLQ3YmwdXUhi0K6VHIw7W3+NPXZkpkmiswVQtbpFKxjPf6pd3MGyj6zJlGX8PMIUz2uuBbJKZqrK5JDgwplRKO/DvHy7foHVQrSCjn41pQhKMFxtLwTgIhjTNHqZM74ZOCpuvkZTUN8qs2U/tt65CI0U9LqlUDs9MO7KcOixZ0j0TDLbACgwZg6l95smlMtR4rio71BgHeO09TGbO5EZUIrbWFzbaIpnbmklWLAVN3tK9u2X3MST+jsmrcErk8Zy0RnfEF33Q+jZU7geKV4QxpDghOfsXrgHzs="
  file: target/wica-http-1.0.0-RELEASE.jar
  skip_cleanup: true
  draft: true
  on:
    repo: paulscherrerinstitute/wica-http

#  provider: pages
#  local_dir: $TRAVIS_BUILD_DIR/target/site/apidocs
#  skip_cleanup: true
#  github_token: $GITHUB_TOKEN  # Set in the settings page of your repository, as a secure variable
#  keep_history: true
#  on:
#    branch: master


after_script:
  - echo -n "*** LIFECYCLE STARTED - 'after_script' *******************************************************************"
  - echo -n "*** LIFECYCLE COMPLETED - 'after_script' *****************************************************************"

