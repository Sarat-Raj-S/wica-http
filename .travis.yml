language: java

jdk:
  - openjdk11

services:
  - docker

addons:
  apt:
    packages:
      - docker-ce

before_install:
  - echo -n "*** LIFECYCLE STARTED - 'before_install' *****************************************************************"
  - echo -n "*** LIFECYCLE COMPLETED - before_install *****************************************************************"

# Note: 'Install' here means things into the Travis environment that are needed.
install:
  - echo "*** LIFECYCLE STARTED - 'install' ***************************************************************************"
  - echo "*** LIFECYCLE COMPLETED - 'install' *************************************************************************"

# Build the code then build the javadoc.
before_script:
  - echo -n "*** LIFECYCLE STARTED - 'before_script' ******************************************************************"
  - mvn package -DskipTests=true -Dmaven.javadoc.skip=true -B -V
#  - mvn javadoc:javadoc -B -V
  - echo -n "*** LIFECYCLE COMPLETED - 'before_script' ****************************************************************"

# Used here to upload the docker file to Docker Hub.
script:
  - echo -n "*** LIFECYCLE STARTED - 'script' *************************************************************************"
#  - echo "$DOCKER_PASSWORD" | docker login -u "$DOCKER_USERNAME" --password-stdin
#  - docker build -t paulscherrerinstitute/wica-stream:latest -f docker/Dockerfile.http .
#  - docker push paulscherrerinstitute/wica-stream:latest
#  - echo -n "LIFECYCLE COMPLETED - 'script' ***************************************************************************"

# The deploy phase is optional and runs after the script. Here we use it to publish
# the Javadoc on the GitHub pages site.
deploy:
  provider: releases
  api_key: "DlZMFAu1qBWA9P555wKKPJbiyNpJppIJIyM9m6UPucbshmYqL28n1/sc4GC5UnVVCQpbRbXH77RLS/X0WVbFaT5S7qQ5c/WCHPclVkykWFwIrj7jFG321Di+U3nel6Xm0o2Fk7r3CRQ1GU4rrIByu3/Q8pQNACJXHZudGyiAGU3B8yTTLDn7bqOm70UnhUVyBYGEq14fpxrvFP2QXY/b7a8z+RYVP88LsCs19sSU3+w/A63kYDRk9ZJ5kQmL40O59qS6KpjfQheHszbzTrHuYvn0jJUnKjuWT34p7ykLAWwr0Bz8BmQt5jvcdY2qAFtnLKmZXaLNTodOGVzLB0lQbddfi45nIQGqiKPVY3XYe/7EWgzyefk9GRn8leD4t0c56ncIKlM4NdH7wAzxTqxmSflbe9CSAUK4qHLTGE55rZvC3YK13pGt+HNR0T9jZvKj8bEdOZ7mCK0ERrJZ5jHeNIxE9lkbdK0G/OgtQpvQK/RqGWofu/O0ypH0rQzZHqBU66P0zMGI9r/627OgBQR9FjdF17inp3k6eWBUT25dI3U85jnkkeuB3ZMc2u64Kpt+n8e46B29/qQTPGmt4Vu1Q+S3IMT+fI1V3CODSMMQQBxZwsjJ783dk+/ogpauVVdMMMzy5Mz7G6ziCa/Dfyk3QCVmxMGu8Vbw1Ve3hUHrL+A="
  file: target/wica-http-1.0.0-RELEASE.jar
  draft: true
  skip_cleanup: true

#  provider: pages
#  local_dir: $TRAVIS_BUILD_DIR/target/site/apidocs
#  skip_cleanup: true
#  github_token: $GITHUB_TOKEN  # Set in the settings page of your repository, as a secure variable
#  keep_history: true
#  on:
#    branch: master


after_script:
  - echo -n "*** LIFECYCLE STARTED - 'after_script' *******************************************************************"
  - echo -n "*** LIFECYCLE COMPLETED - 'after_script' *****************************************************************"

