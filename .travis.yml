language: java

jdk:
  - openjdk11

services:
  - docker

addons:
  apt:
    packages:
      - docker-ce

before_install:
  - echo -n "*** LIFECYCLE STARTED - 'before_install' *****************************************************************"
  - echo -n "*** LIFECYCLE COMPLETED - before_install *****************************************************************"

# Note: 'Install' here means things into the Travis environment that are needed.
install:
  - echo "*** LIFECYCLE STARTED - 'install' ***************************************************************************"
  - echo "*** LIFECYCLE COMPLETED - 'install' *************************************************************************"

# Build the code then build the javadoc.
before_script:
  - echo -n "*** LIFECYCLE STARTED - 'before_script' ******************************************************************"
  - mvn package -DskipTests=true -Dmaven.javadoc.skip=true -B -V
#  - mvn javadoc:javadoc -B -V
  - echo -n "*** LIFECYCLE COMPLETED - 'before_script' ****************************************************************"

# Used here to upload the docker file to Docker Hub.
script:
  - echo -n "*** LIFECYCLE STARTED - 'script' *************************************************************************"
#  - echo "$DOCKER_PASSWORD" | docker login -u "$DOCKER_USERNAME" --password-stdin
#  - docker build -t paulscherrerinstitute/wica-stream:latest -f docker/Dockerfile.http .
#  - docker push paulscherrerinstitute/wica-stream:latest
#  - echo -n "LIFECYCLE COMPLETED - 'script' ***************************************************************************"

# The deploy phase is optional and runs after the script. Here we use it to publish
# the Javadoc on the GitHub pages site.
deploy:
  provider: releases
  api_key:
    secure: eCPJ5vcgE4E/2hqfcNMOU6ym/a7AzDKgG6TjYyJMNdwFk0fs9npfHQVitLxUnkW/LM6oD7uN9XyCAuZU1j9lJ0u3d/Ar5AoJGCqlALJ4tz2vnliFUYwIRdv9J5TZFBE5n2+LyhdKDVxnG4GmSDV5idCVIqLGCZj1HHmKfDKXgbyt2EnJTyTcxQKsY6BQEgDs4AUvlO7XhwU4n/VQ63tZNlI+gDmijMUaaD75PHWu24KI/obDyC0StM2HDHugVt2N3Peek9iyN/SSJ/aqk6G/pRurlm+klGCu4/+z2Gi31VCJQRiiTansZ+xtvg6To0q9clOHq2XSkrFSl4hmqvKw3lWYOkTBNDQUt38P0oV89j2sHuqPZRb82GmiwzMq6wdJ4LCVCKWPQOU5E/cpcUOdpk8S8Lqiy76J1czoYGPsd3rhIqSb/+692bAoFHAllN8Be+p4sOmrhObeR/fy9xDYRPp8r8t68xUWtKtEbrEbtHqtvi6XHEboLBbL5/WWmtSHVJF1nTS+GGXogzUb0uyk2/I9Lnsqlhbnkaxe3Tn81jmH8rpTKJl4jYswml3AuUBKZ0it6hlxsP0vp/rIAzQqWVAVSeuopb5zmP82lPrmjab8NUMBS2kXkRcQ0cgAjwbPBlzRrKvxeq9eHXkNFaFLvc6oeYiV98sWh/ZexdYN2OY=
  file: target/wica-http-1.0.0-RELEASE.jar
  on:
    repo: paulscherrerinstitute/wica-http

#  provider: pages
#  local_dir: $TRAVIS_BUILD_DIR/target/site/apidocs
#  skip_cleanup: true
#  github_token: $GITHUB_TOKEN  # Set in the settings page of your repository, as a secure variable
#  keep_history: true
#  on:
#    branch: master


after_script:
  - echo -n "*** LIFECYCLE STARTED - 'after_script' *******************************************************************"
  - echo -n "*** LIFECYCLE COMPLETED - 'after_script' *****************************************************************"

