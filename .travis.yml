language: java

jdk:
  - openjdk11

services:
  - docker

addons:
  apt:
    packages:
      - docker-ce

before_install:
  - echo -n "*** LIFECYCLE STARTED - 'before_install' *****************************************************************"
  - echo -n "*** LIFECYCLE COMPLETED - before_install *****************************************************************"

# Note: 'Install' here means things into the Travis environment that are needed.
install:
  - echo "*** LIFECYCLE STARTED - 'install' ***************************************************************************"
  - echo "*** LIFECYCLE COMPLETED - 'install' *************************************************************************"

# Build the code then build the javadoc.
before_script:
  - echo -n "*** LIFECYCLE STARTED - 'before_script' ******************************************************************"
  - mvn package -DskipTests=true -Dmaven.javadoc.skip=true -B -V
#  - mvn javadoc:javadoc -B -V
  - echo -n "*** LIFECYCLE COMPLETED - 'before_script' ****************************************************************"

# Used here to upload the docker file to Docker Hub.
script:
  - echo -n "*** LIFECYCLE STARTED - 'script' *************************************************************************"
#  - echo "$DOCKER_PASSWORD" | docker login -u "$DOCKER_USERNAME" --password-stdin
#  - docker build -t paulscherrerinstitute/wica-stream:latest -f docker/Dockerfile.http .
#  - docker push paulscherrerinstitute/wica-stream:latest
#  - echo -n "LIFECYCLE COMPLETED - 'script' ***************************************************************************"

# The deploy phase is optional and runs after the script. Here we use it to publish
# the Javadoc on the GitHub pages site.
deploy:
  provider: releases
  api_key: "XT3vj3emsuWbVNMyVtGl3iWhGw9muDKh2BzIi9RK28QYzMahY/V3ttmAO7le5hnSXvC+WKFvOZyABFrWVL9snpLDlNuaBho2B5h4tX/BHiX7mezM7ludXTk5LdLZa+ZhtGWeuzrb2GL4cifJ2KreNZZaqjN3R667fwU6S7FMtuo5r3qXxQ2gMebcZ8Gb4S3ISOD7eYwIAt+0pC4WSvXuj6kGjuyiDqe5ZxceUe8RzMIH16vlddWmYadxZgJzW5fpj3p62el6pyefokMJhhq9CjtNH2xISVhp4qsYqFL//uFqL5+26xn4NDZLsW45/lOp/uYXx1D2zL2766nqv53msLe1uNXo4Ey6TLgsle0KEo06wWuvKfuKbBSAPOqZyv7BL653pK1L+ywuoQPqMv2TmvftyhIzK3DRmYmoUfVbKVRti+oZnuLfRhsgpeefapBo9TzzDgizJEnCrUO6Ko844D9+SEtAedyGAvYQ4fLHAcuth1VpWwqLHQIQKlEKCf8kEY7ovvXyhJao31hrJOZT0psef4xDVkqXcg6cbaEAFrDIb0fXk0QT9kzPLZLpyT30T+tcUK4VzBJ0PGHy6J+FRv5YOgaYSLzl5HORoPbt2VfaPSBJW84E/Evnz50Nb6gdERgUDk1geg0bARoXWZ+a38B43oe0+YtySpVL2fqn9B0="
  file: target/wica-http-1.0.0-RELEASE.jar
  draft: true
  skip_cleanup: true

#  provider: pages
#  local_dir: $TRAVIS_BUILD_DIR/target/site/apidocs
#  skip_cleanup: true
#  github_token: $GITHUB_TOKEN  # Set in the settings page of your repository, as a secure variable
#  keep_history: true
#  on:
#    branch: master


after_script:
  - echo -n "*** LIFECYCLE STARTED - 'after_script' *******************************************************************"
  - echo -n "*** LIFECYCLE COMPLETED - 'after_script' *****************************************************************"

